<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.


const int nPacT = 2; // number of pacT's
typedef int[0, nPacT-1] id_pacT;


chan needHelp[nPacT], cancelNeed[nPacT];
chan canHelp[nPacT], cancelHelp[nPacT];
chan helpRequest;
chan requestApproved, requestDenied, requestCanceled;
broadcast chan helpArrived;
broadcast chan problemSolved;
broadcast chan prepareDone;


const int MAX_DISTANCE = 500; //Meters
int leaderPrio;
int coordinates;

void putData(int pLeaderPrio, int pCoordinates) {
	leaderPrio = pLeaderPrio;
	coordinates = pCoordinates;
}

bool check(int pLeaderPrio, int pCoordinates){
	return (leaderPrio &gt; pLeaderPrio &amp;&amp; (coordinates - pCoordinates) &lt; MAX_DISTANCE);
}
</declaration><template><name x="5" y="5">Synchronization</name><parameter>const id_pacT id</parameter><declaration>// Place local declarations here.
</declaration><location id="id0" x="-648" y="-40"><name x="-688" y="-24">RemoverRole</name></location><location id="id1" x="-848" y="-216"><name x="-888" y="-248">CallerRole</name></location><location id="id2" x="-448" y="-216"><name x="-458" y="-246">HelperRole</name></location><location id="id3" x="-648" y="-216"><name x="-640" y="-208">IDLE</name></location><init ref="id3"/><transition><source ref="id3"/><target ref="id2"/><label kind="synchronisation" x="-576" y="-240">canHelp[id]!</label></transition><transition><source ref="id2"/><target ref="id3"/><label kind="synchronisation" x="-592" y="-320">cancelHelp[id]!</label><nail x="-552" y="-304"/></transition><transition><source ref="id1"/><target ref="id3"/><label kind="synchronisation" x="-792" y="-320">cancelNeed[id]!</label><nail x="-752" y="-304"/></transition><transition><source ref="id0"/><target ref="id3"/><label kind="synchronisation" x="-696" y="-136">problemSolved?</label></transition><transition><source ref="id1"/><target ref="id0"/><label kind="synchronisation" x="-840" y="-64">helpArrived?</label><nail x="-848" y="-40"/></transition><transition><source ref="id2"/><target ref="id0"/><label kind="synchronisation" x="-528" y="-64">helpArrived?</label><nail x="-448" y="-40"/></transition><transition><source ref="id3"/><target ref="id1"/><label kind="synchronisation" x="-784" y="-240">needHelp[id]!</label></transition></template><template><name>CallerRole</name><parameter>const id_pacT id, int myPrio</parameter><declaration>clock t0;
int coordinates = 100;
bool solvedAlone = false;</declaration><location id="id4" x="-16" y="-184"><name x="-8" y="-208">waiting</name></location><location id="id5" x="-416" y="-176"><name x="-480" y="-208">Standalone</name></location><location id="id6" x="-416" y="0"><name x="-408" y="-32">called</name><label kind="comments">(in community)</label></location><location id="id7" x="-200" y="-176"><name x="-232" y="-216">requesting</name></location><init ref="id5"/><transition><source ref="id6"/><target ref="id5"/><label kind="synchronisation" x="-552" y="-104">requestCanceled!</label><nail x="-440" y="-96"/></transition><transition><source ref="id4"/><target ref="id6"/><label kind="synchronisation" x="-8" y="-72">requestApproved?</label><nail x="-16" y="-8"/></transition><transition><source ref="id4"/><target ref="id7"/><label kind="synchronisation" x="-152" y="-128">requestDenied?</label><nail x="-104" y="-128"/></transition><transition><source ref="id7"/><target ref="id4"/><label kind="synchronisation" x="-152" y="-264">helpRequest!</label><label kind="assignment" x="-184" y="-248">putData(myPrio, coordinates)</label><nail x="-112" y="-232"/></transition><transition><source ref="id7"/><target ref="id5"/><label kind="synchronisation" x="-360" y="-248">cancelNeed[id]?</label><nail x="-312" y="-224"/></transition><transition><source ref="id6"/><target ref="id5"/><label kind="synchronisation" x="-384" y="-104">helpArrived?</label><nail x="-392" y="-96"/></transition><transition><source ref="id5"/><target ref="id7"/><label kind="synchronisation" x="-344" y="-176">needHelp[id]?</label></transition></template><template><name>HelperRole</name><parameter>const id_pacT id, int myPrio</parameter><declaration>int coordinates = 100;
clock t0;</declaration><location id="id8" x="-2368" y="-1040"><name x="-2408" y="-1080">Standalone</name></location><location id="id9" x="-2224" y="-1040"><name x="-2248" y="-1072">ready</name></location><location id="id10" x="-1776" y="-1040"><name x="-1760" y="-1056">travelToCaller</name></location><location id="id11" x="-2032" y="-1040"><name x="-2064" y="-1080">checking</name></location><init ref="id8"/><transition><source ref="id10"/><target ref="id8"/><label kind="synchronisation" x="-2080" y="-1240">helpArrived!</label><nail x="-2040" y="-1224"/></transition><transition><source ref="id9"/><target ref="id8"/><label kind="synchronisation" x="-2336" y="-952">cancelHelp[id]?</label><nail x="-2296" y="-952"/></transition><transition><source ref="id8"/><target ref="id9"/><label kind="synchronisation" x="-2328" y="-1064">canHelp[id]?</label></transition><transition><source ref="id10"/><target ref="id9"/><label kind="synchronisation" x="-2072" y="-1152">requestCanceled?</label><nail x="-2008" y="-1136"/></transition><transition><source ref="id11"/><target ref="id9"/><label kind="guard" x="-2208" y="-960">!check(myPrio, coordinates)</label><label kind="synchronisation" x="-2176" y="-944">requestDenied!</label><nail x="-2128" y="-960"/></transition><transition><source ref="id9"/><target ref="id11"/><label kind="synchronisation" x="-2168" y="-1064">helpRequest?</label></transition><transition><source ref="id11"/><target ref="id10"/><label kind="guard" x="-2000" y="-1064">check(myPrio, coordinates)</label><label kind="synchronisation" x="-1968" y="-1040">requestApproved!</label></transition></template><template><name>RemoverRole</name><parameter>const id_pacT id</parameter><declaration>clock t0;
bool partnerDone = false;</declaration><location id="id12" x="-368" y="-136"><name x="-378" y="-166">idle</name></location><location id="id13" x="8" y="-136"><name x="-40" y="-176">removeObject</name></location><location id="id14" x="-200" y="-136"><name x="-240" y="-168">prepareTask</name></location><init ref="id12"/><transition><source ref="id13"/><target ref="id13"/><label kind="synchronisation" x="152" y="-152">prepareDone?</label><label kind="assignment" x="152" y="-136">partnerDone = true</label><nail x="144" y="-200"/><nail x="144" y="-64"/></transition><transition><source ref="id14"/><target ref="id14"/><label kind="synchronisation" x="-248" y="-88">prepareDone?</label><label kind="assignment" x="-256" y="-72">partnerDone = true</label><nail x="-240" y="-88"/><nail x="-168" y="-88"/></transition><transition><source ref="id13"/><target ref="id12"/><label kind="synchronisation" x="-248" y="-256">problemSolved?</label><nail x="-200" y="-240"/></transition><transition><source ref="id13"/><target ref="id12"/><label kind="guard" x="-256" y="8">partnerDone == true</label><label kind="synchronisation" x="-248" y="24">problemSolved!</label><nail x="-208" y="0"/></transition><transition><source ref="id12"/><target ref="id14"/><label kind="synchronisation" x="-328" y="-152">helpArrived?</label></transition><transition><source ref="id14"/><target ref="id13"/><label kind="synchronisation" x="-144" y="-152">prepareDone!</label></transition></template><system>// Place template instantiations here.
caller0 = CallerRole(0, 8);
helper0 = HelperRole(0, 3);
remover0 = RemoverRole(0);
synch0 = Synchronization(0);

caller1 = CallerRole(1, 2);
helper1 = HelperRole(1, 5);
remover1 = RemoverRole(1);
synch1 = Synchronization(1);

// List one or more processes to be composed into a system.
system caller0, helper0, remover0, synch0, caller1, helper1, remover1, synch1;</system></nta>