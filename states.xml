<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.

const int MAX_PRIO = 10;

chan needHelp, cancelHelp;
chan helpRequest;
chan requestApproved, requestDenied;
broadcast chan helpArrived;
chan problemSolved;


const int MAX_DISTANCE = 500; //Meters
int leaderPrio;
int coordinates;

void putData(int pLeaderPrio, int pCoordinates) {
	leaderPrio = pLeaderPrio;
	coordinates = pCoordinates;
}

bool check(int pLeaderPrio, int pCoordinates){
	return (leaderPrio &gt; pLeaderPrio &amp;&amp; (coordinates - pCoordinates) &lt; MAX_DISTANCE);
}
</declaration><template><name x="5" y="5">Synchronization</name><declaration>// Place local declarations here.
</declaration><location id="id0" x="-648" y="-40"><name x="-640" y="-64">RemoverRole</name></location><location id="id1" x="-848" y="-216"><name x="-888" y="-248">CallerRole</name></location><location id="id2" x="-360" y="-216"><name x="-370" y="-246">HelperRole</name></location><location id="id3" x="-648" y="-216"><name x="-640" y="-208">IDLE</name></location><init ref="id3"/><transition><source ref="id3"/><target ref="id2"/><label kind="synchronisation" x="-552" y="-240">helpRequest?</label></transition><transition><source ref="id2"/><target ref="id3"/><label kind="synchronisation" x="-472" y="-320">cancelHelp?</label><nail x="-496" y="-312"/></transition><transition><source ref="id1"/><target ref="id3"/><label kind="synchronisation" x="-792" y="-320">cancelHelp?</label><nail x="-752" y="-304"/></transition><transition><source ref="id0"/><target ref="id3"/><label kind="synchronisation" x="-708" y="-143">problemSolved?</label></transition><transition><source ref="id1"/><target ref="id0"/><label kind="synchronisation" x="-840" y="-56">helpArrived?</label><nail x="-848" y="-40"/></transition><transition><source ref="id2"/><target ref="id0"/><label kind="synchronisation" x="-448" y="-64">helpArrived?</label><nail x="-360" y="-40"/></transition><transition><source ref="id3"/><target ref="id1"/><label kind="synchronisation" x="-784" y="-240">needHelp?</label></transition></template><template><name>CallerRole</name><parameter>int myPrio</parameter><declaration>clock t0;
int coordinates = 100;
bool solvedAlone = false;</declaration><location id="id4" x="-416" y="-8"><name x="-472" y="-24">solved</name></location><location id="id5" x="-416" y="-176"><name x="-426" y="-206">Standalone</name></location><location id="id6" x="-200" y="-8"><name x="-184" y="-16">called</name><label kind="comments">(in community)</label></location><location id="id7" x="-200" y="-176"><name x="-176" y="-192">requesting</name><label kind="invariant" x="-176" y="-176">t0 &lt;= 10</label></location><init ref="id5"/><transition><source ref="id6"/><target ref="id5"/><label kind="synchronisation" x="-304" y="-112">helpArrived?</label></transition><transition><source ref="id4"/><target ref="id5"/><label kind="synchronisation" x="-496" y="-136">cancelHelp!</label></transition><transition><source ref="id6"/><target ref="id4"/><label kind="guard" x="-368" y="-38">solvedAlone</label></transition><transition><source ref="id5"/><target ref="id7"/><label kind="guard" x="-304" y="-200">true</label><label kind="synchronisation" x="-352" y="-160">helpRequest!</label><label kind="assignment" x="-400" y="-176">putData(myPrio, coordinates)</label></transition><transition><source ref="id7"/><target ref="id7"/><label kind="guard" x="-256" y="-311">t0 == 10</label><label kind="synchronisation" x="-256" y="-296">helpRequest!</label><label kind="assignment" x="-256" y="-280">t0 = 0,
putData(myPrio, coordinates)</label><nail x="-272" y="-264"/><nail x="-184" y="-264"/></transition><transition><source ref="id7"/><target ref="id6"/><label kind="synchronisation" x="-192" y="-136">requestApproved?</label></transition></template><template><name>HelperRole</name><parameter>int myPrio</parameter><declaration>int coordinates = 100;
clock t0;</declaration><location id="id8" x="-1808" y="-1040"><name x="-1792" y="-1056">travelToCaller</name><label kind="invariant" x="-1818" y="-1025">t0 &lt;= 10</label></location><location id="id9" x="-2032" y="-1040"><name x="-2112" y="-1080">Standalone</name></location><init ref="id9"/><transition><source ref="id8"/><target ref="id9"/><label kind="synchronisation" x="-1960" y="-1168">cancelHelp?</label><nail x="-1920" y="-1152"/></transition><transition><source ref="id8"/><target ref="id9"/><label kind="guard" x="-1960" y="-1248">t0 == 10</label><label kind="synchronisation" x="-1976" y="-1216">helpArrived!</label><nail x="-1808" y="-1216"/><nail x="-2032" y="-1216"/></transition><transition><source ref="id9"/><target ref="id9"/><label kind="guard" x="-2120" y="-944">!check(myPrio, coordinates)</label><label kind="synchronisation" x="-2080" y="-960">requestDenied!</label><nail x="-1984" y="-960"/><nail x="-2080" y="-960"/></transition><transition><source ref="id9"/><target ref="id8"/><label kind="guard" x="-2008" y="-1064">check(myPrio, coordinates)</label><label kind="synchronisation" x="-1976" y="-1040">requestApproved!</label><label kind="assignment" x="-1960" y="-1024">t0 = 0</label></transition></template><template><name>RemoverRole</name><declaration>clock t0;</declaration><location id="id10" x="8" y="-136"><name x="-2" y="-166">removeObject</name></location><location id="id11" x="-224" y="-136"><name x="-328" y="-144">prepareTask</name><label kind="invariant" x="-320" y="-120">t0 &lt;= 10</label></location><init ref="id11"/><transition><source ref="id10"/><target ref="id11"/><label kind="synchronisation" x="-160" y="-16">problemSolved!</label><label kind="assignment" x="-136" y="-32">t0 = 0</label><nail x="-120" y="-32"/></transition><transition><source ref="id11"/><target ref="id10"/><label kind="guard" x="-144" y="-160">t0 == 10</label></transition></template><system>// Place template instantiations here.
caller1 = CallerRole(8);
helper1 = HelperRole(3);
remover1 = RemoverRole();
synch1 = Synchronization();

// List one or more processes to be composed into a system.
system caller1, helper1, remover1, synch1;</system></nta>